# GS-Customized-Email-Merge

🚀 **一個專為 Gmail 與 Google Sheets 設計的輕量化郵件合併工具，完美支援 Emoji 並具備預覽功能。**

這套工具是由學校研究人員為了處理大量產學合作信件而開發，特別針對 Emoji 亂碼問題進行了底層編碼優化。

## 🌟 核心功能

- **視覺化選擇範本**：直接從您的 Gmail 草稿匣中選擇任何一封郵件作為範本。
- **Emoji 完美支援**：自動將 Emoji 轉換為 HTML 安全代碼，完美支援 emoji 發送。
- **雙模式操作**：支援「僅產生草稿」與「直接寄出郵件」兩種模式。
- **即時預覽**：在正式寄出前，可產生、預覽第一封郵件的套印效果。
- **自動進度紀錄**：自動在試算表 D 欄標記執行狀態與時間戳記（Timestamp）。
- **多變數相容**：同時支援 `{{姓名}}` / `{{Name}}` 與 `{{公司}}` / `{{Company}}` 標籤。

## ⚠️ 重要聲明與使用風險 (Disclaimer & Usage Risks)

在使用本工具進行自動化郵件發送前，請務必閱讀並理解以下說明。**使用者須對其發送行為負全部法律與帳號安全責任**：

### 1. Google 寄送配額限制

* **每日限額**：一般 Gmail 帳號每日發送上限為 **500 封**，Google Workspace 帳號上限為 **2000 封**。超過限額將導致 24 小時內無法寄信。
* **暫時停權**：短時間內大量發信可能觸發 Google 安全機制，導致帳號被暫時鎖定或要求電話驗證。

### 2. 垃圾郵件 (Spam) 標註風險

* **網域聲譽受損**：若郵件內容被收件者頻繁標註為「垃圾郵件」，您的寄件者網域聲譽將大幅下降，未來寄出的信件將有極高機率直接進入他人的垃圾郵件箱。
* **黑名單 (Blacklist)**：若發送頻率過高且內容高度重複，您的郵件地址或 IP 可能被國際反垃圾郵件組織列入黑名單，影響該網域下所有使用者的通訊。

### 3. 帳號永久停權

* **違反服務條款**：Google 嚴格禁止利用其平台發送未經許可的商業廣告、釣魚資訊或騷擾信件。若經舉報屬實，Google 有權在不事先通知的情況下**永久停權**您的帳號。

### 4. 法律合規性

* **反垃圾郵件法**：請確保您的發送行為符合當地法律（如台灣《濫發商業電子郵件管理條例》、美國 CAN-SPAM Act 或歐盟 GDPR）。
* **退訂機制**：對於商業或大量群發郵件，法律通常要求提供明確的退訂途徑或拒絕接受後續郵件的權利。

### 5. 開源責任聲明

本工具僅供學術交流、產學聯絡（如校務研究、計畫通訊）或企業內部合法管理使用。開發者不保證本工具在所有環境下皆能免於 Google 的過濾偵測，亦不對使用者因使用本工具導致的帳號封鎖、資料遺失或任何法律糾紛負責。

---

**建議預防措施：**

* **先預覽再執行**：務必使用內建的「預覽」功能確認內容。
* **控制發送節奏**：建議分批發送，或在不同時間段執行套印。
* **內容差異化**：妥善利用 `{{姓名}}` 與 `{{公司}}` 標籤，增加信件的個人化程度。

---

## 🛠️ 使用步驟

1. **建立試算表**：
   - A 欄：公司名稱
   - B 欄：收件人姓名
   - C 欄：Email 地址
   - D 欄：(保留給系統紀錄狀態)

2. **開啟 Apps Script**：
   - 在試算表中點選 `擴充功能` > `Apps Script`。

3. **貼入程式碼**：
   - 將本專案中的 `Code.gs` 內容貼入腳本編輯器。
   - 點選 `+` 新增一個 HTML 檔案，命名為 `DraftPicker.html`，並貼入對應內容。

4. **撰寫範本**：
   - 在您的 Gmail 中撰寫一封草稿。
   - 主旨或內文可使用 `{{姓名}}` 或 `{{公司}}` 作為變數。

5. **執行**：
   - 重新整理試算表，點選上方選單 `📧 郵件自動化` > `選擇草稿並套印`。

## 📋 變數說明

本系統會自動偵測並替換以下標籤（不分大小寫）：
- `{{姓名}}` 或 `{{Name}}`：替換為試算表 B 欄內容。
- `{{公司}}` 或 `{{Company}}`：替換為試算表 A 欄內容。

## 🛡️ 安全性說明

本工具僅使用 Google 官方提供的 `GmailApp` API 進行草稿讀取與郵件寄送。所有資料皆儲存在您的 Google 帳戶空間內，不會將任何資料傳送至第三方伺服器。

## 📝 授權協議

MIT License
